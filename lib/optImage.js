(()=>{"use strict";var e={432:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(384));class i extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const e=this.getAttribute("image-url"),t=this.getAttribute("height"),r=this.getAttribute("resolutions");if(!e)throw new Error("Image url cannot be undefined or null.");const n=document.createElement("picture"),s=new o.default,a=r?i._getResolutions(r):[320,480,800];let u=0;for(const r of a)this._generateResizedImage({url:e,width:r,height:Number(t)}).then((e=>{i._renderPicture(e,n,r),u===a.length-1&&n.appendChild(e),u++}));const c=s.addStyle("img { width: 100%; object-fit: cover; }");this.shadowRoot.adoptedStyleSheets=[c],this.shadowRoot.appendChild(n)}_generateResizedImage({url:e,width:t,height:r}){return new Promise(((n,o)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const e=document.createElement("canvas"),s=e.getContext("2d");if(!s)return void o(new Error("Canvas 2D context is not supported."));const a=i.height/i.width,u=r||Math.round(t*a);e.width=t,e.height=u;try{s.drawImage(i,0,0,t,u);const r=document.createElement("img");r.src=e.toDataURL("image/webp"),r.alt=`${t}x${u}`,n(r)}catch(e){o(new Error("Error drawing image on canvas."))}},i.onerror=()=>{o(new Error("Error loading image."))},i.onabort=()=>{o(new Error("Image loading aborted."))},i.src=`${e}?width=${t}`}))}static _renderPicture(e,t,r){const n=document.createElement("source");n.setAttribute("srcset",e.src),n.setAttribute("media",`(max-width: ${r}px)`),t.appendChild(n)}static _getResolutions(e){if("string"==typeof e){const t=e.split(",").map((e=>e.trim())),r=t.map(Number).filter(s);if(r.length!==t.length)throw new Error("Resolutions has invalid values.");return r}if(!e.length)throw new Error("Resolutions cannot be empty, try provide your custom resolutions like this: '100,200,300'");return e.map((e=>{const t="number"==typeof e?e:Number(e);if(!s(t))throw new Error("Resolutions has invalid values.");return t}))}}function s(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)&&0!==e}customElements.define("opt-image",i)},384:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{addStyle(e){const t=new CSSStyleSheet;return t.replaceSync(e),t}}}},t={};!function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(432)})();